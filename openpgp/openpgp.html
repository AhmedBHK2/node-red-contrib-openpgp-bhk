<script type="text/x-red" data-template-name="PGP_GENERATE_KEY_PAIR">
</script>
         
<script type="text/x-red" data-help-name="PGP_GENERATE_KEY_PAIR">
    <p>
        This node generates a new key pair.
        <br>
        Inputs:<br>

        <ul>
            <li>user name: <b> msg.encryption.name </b>( encodedURIComponent)</li>
            <li>user email: <b> msg.encryption.email </b>( encodedURIComponent)</li>
            <li>passphrase: <b>msg.encryption.passphrase</b></li>
        </ul>
        <br>
        Outputs:
        <br>
        <ul>
            <li>new generated public key: <b> msg.keyPair.publicKey </b></li>
            <li>new generated private key: <b> msg.keyPair.privateKey </b></li>
        </ul>

    </p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('PGP_GENERATE_KEY_PAIR',{
        category: 'BHK',      // the palette category
        color:"#E6E0F8",
        defaults: {             // defines the editable properties of the node
            name: {value:"PGP_GENERATE_KEY_PAIR"}   //  along with default values.
        },
        inputs:1,                // set the number of inputs - only 0 or 1
        outputs:1,               // set the number of outputs - 0 to n
        icon: "arrow-in.png",    // set the icon (held in public/icons)
        label: function() {      // sets the default label contents
            return this.name||this.topic||"PGP_GENERATE_KEY_PAIR";
        },
        labelStyle: function() { // sets the class to apply to the label
            return this.name?"node_label_italic":"";
        }
    });
</script>

<script type="text/x-red" data-template-name="PGP_ENCRYPT">
</script>
                
<script type="text/x-red" data-help-name="PGP_ENCRYPT">
    <p>
        This node allows to encrypt a clear text into a PGP message using public key for encryption.
        <br>
        Inputs:<br>

        <ul>
            <li>Receiver armored public key: <b> msg.encryption.receiverPublicKey </b>( encodedURIComponent)</li>
            <li>Clear text to encrypt: <b> msg.encryption.rawText </b>( encodedURIComponent)</li>
        </ul>
        <br>
        Output:
        <br>
        Encrypted PGP message: <b>msg.encrypted</b>

    </p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('PGP_ENCRYPT',{
        category: 'BHK',      // the palette category
        color:"#E6E0F8",
        defaults: {             // defines the editable properties of the node
            name: {value:"PGP_ENCRYPT"}   //  along with default values.
        },
        inputs:1,                // set the number of inputs - only 0 or 1
        outputs:1,               // set the number of outputs - 0 to n
        icon: "arrow-in.png",    // set the icon (held in public/icons)
        label: function() {      // sets the default label contents
            return this.name||this.topic||"PGP_ENCRYPT";
        },
        labelStyle: function() { // sets the class to apply to the label
            return this.name?"node_label_italic":"";
        }
    });
</script>


<script type="text/x-red" data-template-name="PGP_DECRYPT">
</script>
                
<script type="text/x-red" data-help-name="PGP_DECRYPT">
    <p>
        This node allows to decrypt an unsigned pgp message using receiver public key.
        <br>
        Inputs:<br>

        <ul>
            <li>Receiver armored private key : <b>msg.encryption.receiverPrivateKey</b></li>
            <li>Passphrase to decode private key: <b>msg.encryption.passphrase</b></li>
            <li>Encrypted pgp message: <b>msg.encryption.encryptedMessage</b></li>
        </ul>
        <br>
        Output:
        <br>
        Clear text got as a result of decryption: <b>msg.decrypted</b>

    </p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('PGP_DECRYPT',{
        category: 'BHK',      // the palette category
        color:"#E6E0F8",
        defaults: {             // defines the editable properties of the node
            name: {value:"PGP_DECRYPT"}   //  along with default values.
        },
        inputs:1,                // set the number of inputs - only 0 or 1
        outputs:1,               // set the number of outputs - 0 to n
        icon: "arrow-in.png",    // set the icon (held in public/icons)
        label: function() {      // sets the default label contents
            return this.name||this.topic||"PGP_DECRYPT";
        },
        labelStyle: function() { // sets the class to apply to the label
            return this.name?"node_label_italic":"";
        }
    });
</script>

<script type="text/x-red" data-template-name="PGP_ENCRYPT_SIGN">
</script>
                
<script type="text/x-red" data-help-name="PGP_ENCRYPT_SIGN">
    <p>
        This node allows to encrypt a clear text into a signed PGP message using public key for encryption and private key for signature.
        <br>
        Inputs:<br>

        <ul>
            <li>Sender armored private key : <b>msg.encryption.senderPrivateKey</b></li>
            <li>Sender passphrase : <b>msg.encryption.passphrase</b></li>
            <li>Receiver armored public key: <b> msg.encryption.receiverPublicKey </b>( encodedURIComponent)</li>
            <li>Clear text to encrypt: <b> msg.encryption.rawText </b>( encodedURIComponent)</li>
        </ul>
        <br>
        Output:
        <br>
        Encrypted PGP message: <b>msg.encrypted</b>

    </p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('PGP_ENCRYPT_SIGN',{
        category: 'BHK',      // the palette category
        color:"#E6E0F8",
        defaults: {             // defines the editable properties of the node
            name: {value:"PGP_ENCRYPT_SIGN"}   //  along with default values.
        },
        inputs:1,                // set the number of inputs - only 0 or 1
        outputs:1,               // set the number of outputs - 0 to n
        icon: "arrow-in.png",    // set the icon (held in public/icons)
        label: function() {      // sets the default label contents
            return this.name||this.topic||"PGP_ENCRYPT_SIGN";
        },
        labelStyle: function() { // sets the class to apply to the label
            return this.name?"node_label_italic":"";
        }
    });
</script>


<script type="text/x-red" data-template-name="PGP_DECRYPT_SIGNED">
</script>
                
<script type="text/x-red" data-help-name="PGP_DECRYPT_SIGNED">
    <p>
        This node allows to decrypt a signed pgp message using receiver private key for decryption and sender public key for signature check.
        <br>
        Inputs:<br>

        <ul>
            <li>Receiver armored public key: <b> msg.encryption.senderPublicKey </b>( encodedURIComponent)</li>
            <li>Receiver armored private key : <b>msg.encryption.receiverPrivateKey</b></li>
            <li>Passphrase to decode private key: <b>msg.encryption.passphrase</b></li>
            <li>Encrypted pgp message: <b>msg.encryption.encryptedMessage</b></li>
        </ul>
        <br>
        Output:
        <br>
        Clear text got as a result of decryption: <b>msg.decrypted</b>

    </p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('PGP_DECRYPT_SIGNED',{
        category: 'BHK',      // the palette category
        color:"#E6E0F8",
        defaults: {             // defines the editable properties of the node
            name: {value:"PGP_DECRYPT_SIGNED"}   //  along with default values.
        },
        inputs:1,                // set the number of inputs - only 0 or 1
        outputs:1,               // set the number of outputs - 0 to n
        icon: "arrow-in.png",    // set the icon (held in public/icons)
        label: function() {      // sets the default label contents
            return this.name||this.topic||"PGP_DECRYPT_SIGNED";
        },
        labelStyle: function() { // sets the class to apply to the label
            return this.name?"node_label_italic":"";
        }
    });
</script>